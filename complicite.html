<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Complicit√© - ICAM Games</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div style="padding: 10px 0;">
            <a href="index.html" style="text-decoration:none; font-size: 1.5rem;">üè†</a>
        </div>
        
        <div id="comp-setup">
            <h1 style="color:var(--neon-blue); text-align:center;">Complicit√©</h1>
            <div class="config-box" style="background:rgba(20,20,20,0.8); padding:20px; border-radius:20px;">
                <label>Objectif de points (0 = Infini)</label>
                <div class="config-row">
                    <input type="number" id="win-score-input" value="10">
                </div>
                
                <label style="margin-top:15px; display:block;">√âquipes</label>
                <div id="teams-container"></div>
                
                <button class="btn btn-neutral" onclick="addTeam()" style="width:100%; margin-top:10px;">+ Ajouter √âquipe</button>
            </div>
            <button class="btn btn-primary" onclick="startCompliciteGame()" style="width:100%; margin-top:20px;">Lancer la partie</button>
        </div>

        <div id="comp-game" class="hidden">
            <div id="scoreboard"></div>
            <div id="turn-indicator" style="text-align:center; margin-bottom:15px; font-weight:bold; color:var(--neon-blue);"></div>

            <div id="word-to-guess" class="word-display">MOT</div>

            <div id="hold-zone" class="hold-zone">
                <div id="hold-instruction">üëÜ MAINTIENS POUR VOIR</div>
            </div>

            <div class="game-controls">
                <button class="btn btn-found" onclick="roundEnd('win')">‚úÖ Trouv√© !</button>
                <button class="btn btn-intercept" onclick="handleStealAttempt()">üòà Intercept√© !</button>
                <button class="btn btn-neutral" onclick="roundEnd('skip')">‚ò†Ô∏è Rat√© / Tabou</button>
            </div>
        </div>
    </div>

    <div id="modal-steal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 style="color:var(--neon-red)">Qui a vol√© le point ?</h3>
            <div id="steal-buttons-container" class="game-controls"></div>
            <button class="btn btn-neutral" onclick="closeModal('modal-steal')">Annuler</button>
        </div>
    </div>

    <div id="modal-victory" class="modal-overlay hidden">
        <div class="modal-content">
            <h1 style="font-size:4rem; margin:0;">üèÜ</h1>
            <h2 id="winner-name" style="color:var(--neon-green); font-size:2rem;">VICTOIRE</h2>
            <button class="btn btn-primary" onclick="location.reload()" style="width:100%; margin-top:20px;">REJOUER</button>
        </div>
    </div>

    <script>
        const baseWords = [
  "Brosse √† dents", "Micro-ondes", "Harry Potter", "Batman", "Zidane", "Pizza",
  "Raclette", "Sushi", "Pigeon", "Moustique", "Licorne", "Vomir", "Danser",
  "Pleurer", "Iphone", "Lave-vaisselle", "Tondeuse", "Frigo", "Parapluie",
  "Sac √† dos", "Valise", "Dentifrice", "Savon", "Miroir", "Montre", "Bague",
  "Basket", "Cravate", "Chapeau", "√âcharpe", "Pull", "Aspirateur", "Po√™le",
  "Casserole", "Couteau", "Bouteille", "Ordinateur", "Tablette", "Console",
  "Manette", "Livre", "Cin√©ma", "Zoo", "Restaurant", "Avion", "Train",
  "Voiture", "Fus√©e", "Skateboard", "Surf", "Soleil", "Pluie", "Orage",
  "Robot", "Internet", "Selfie",

  "Stylo", "Crayon", "Feutre", "Gomme", "Cahier", "Classeur", "Cartable",
  "Bureau", "Chaise", "Canap√©", "Lit", "Oreiller", "Couette", "Rideau",
  "Lampe", "Ampoule", "Prise", "Interrupteur", "T√©l√©vision", "T√©l√©commande",
  "Radio", "Casque", "√âcouteurs", "Micro", "Clavier", "Souris", "√âcran",
  "Imprimante", "Scanner", "C√¢ble", "Chargeur", "Batterie", "Horloge",
  "Calendrier", "Agenda", "R√©veil", "Montagne", "For√™t", "Rivi√®re", "Oc√©an",
  "Plage", "D√©sert", "Neige", "Glace", "Vent", "Nuage", "Arc-en-ciel",
  "√âtoile", "Lune", "Plan√®te", "Astronaute", "Satellite", "T√©lescope",
  "Boussole", "Carte", "GPS", "Porte", "Fen√™tre", "Mur", "Plafond", "Sol",
  "Escalier", "Ascenseur", "Cl√©", "Serrure", "Cadenas", "Sac",
  "Portefeuille", "Billet", "Pi√®ce", "Banque", "Carte bleue", "Ticket",
  "Facture", "Stylet", "Table", "Tabouret", "Armoire", "Placard", "√âtag√®re",
  "Tiroir", "Bo√Æte", "Carton", "Papier", "Enveloppe", "Timbre", "Colis",
  "Livreur", "Facteur", "Camion", "Bus", "Tramway", "M√©tro", "Taxi", "V√©lo",
  "Trottinette", "Gilet", "Feu rouge", "Panneau", "Route", "Autoroute",
  "Carrefour", "Rond-point", "Tunnel", "Pont", "Parking",

  "Cl√© USB", "Disque dur", "Cloud", "Mot de passe", "Code", "Bug", "Virus",
  "Firewall", "R√©seau", "Wifi", "Bluetooth", "Application", "Logiciel",
  "Algorithme", "Donn√©e", "Serveur", "Base de donn√©es",

  "Chien", "Chat", "Lapin", "Hamster", "Poisson", "Requin", "Dauphin",
  "Baleine", "Lion", "Tigre", "√âl√©phant", "Girafe", "Z√®bre", "Singe",
  "Serpent", "Araign√©e", "Fourmi", "Abeille", "Papillon", "Escargot",
  "Coq", "Poulet", "Vache", "Mouton", "Ch√®vre", "Cheval",

  "Fromage", "Pain", "Beurre", "Confiture", "Miel", "Sucre", "Sel", "Poivre",
  "√âpices", "P√¢tes", "Riz", "Burger", "Frites", "Sandwich", "Kebab",
  "Lasagnes", "Soupe", "Salade", "G√¢teau", "Cookie", "Chocolat", "Bonbon",
  "Glace", "Yaourt", "C√©r√©ales",

  "Caf√©", "Th√©", "Lait", "Jus", "Soda", "Eau", "Sirop", "Bi√®re", "Vin",
  "Cocktail", "Verre", "Tasse", "Mug", "Bol", "Assiette", "Fourchette",
  "Cuill√®re", "Serviette", "Nappe",

  "M√©decin", "Infirmier", "H√¥pital", "Pharmacie", "M√©dicament", "Vaccin",
  "Thermom√®tre", "Pansement", "Pl√¢tre", "IRM",

  "√âcole", "Coll√®ge", "Lyc√©e", "Universit√©", "Professeur", "√âtudiant",
  "Examen", "Note", "Dipl√¥me", "Stage", "Entreprise", "R√©union", "Planning",
  "Deadline", "Projet", "Objectif", "M√©thode",

  "Sport", "Football", "Rugby", "Basketball", "Tennis", "Padel",
  "Natation", "Course", "Musculation", "Yoga", "Boxe", "Escalade",

  "Cin√©ma", "Th√©√¢tre", "Concert", "Mus√©e", "Exposition", "Festival",
  "Peinture", "Dessin", "Photo", "Cam√©ra", "Montage",

  "Amour", "Amiti√©", "Col√®re", "Joie", "Tristesse", "Stress", "Rire",
  "Sourire", "Cri", "Silence", "Secret", "R√™ve", "Chance", "Hasard",
  "Succ√®s", "√âchec", "Victoire", "D√©faite"
  "Flou", "Bancal", "D√©rapage", "Echo", "Plis", "Grain", "Virage",
  "D√©clic", "Saut", "Fuite", "Angle mort", "Reflet", "Br√®che",
  "D√©rive", "Noeud", "Pulse", "Trace", "Rebond", "Pic",
  "Creux", "Choc", "Coulisse", "Arr√™t", "Reprise", "Fil",
  "Brouillon", "Indice", "Masque", "Sillage", "Pause",
  "Coupure", "Relais", "Faille", "Marge", "Biais",
  "√âcart", "S√©rie", "Fragment", "Blocage", "Glissement",
  "Pointill√©", "Lapsus", "Contour", "Rayure", "Vague",
  "Pression", "D√©tour", "R√©sidu", "Griffe", "Secousse",
  "Bascule", "Intervalle", "Niveau z√©ro", "Impact",
  "P√©riph√©rie", "Centre flou", "D√©crochement",
  "Accroche", "Tension", "Densit√©", "Silence blanc",
  "Fond sonore", "Variation lente", "Instant fig√©",
  "Micro-moment", "D√©calque", "Empreinte",
  "Rotation", "Phase creuse", "Effet domino",
  "Zone grise", "Limbe", "Suspension",
  "D√©clencheur", "Oscillation",
  "Fracture douce", "Rupture nette",
  "√âquilibre instable", "D√©sax√©",
  "Surcharge", "Vide plein",
  "Bordure", "Inflexion",
  "Signal faible", "Bruissement"
]

];

        let words = [...baseWords];
        let teams = [{ name: "√âquipe A", score: 0 }, { name: "√âquipe B", score: 0 }];
        let winningScore = 0;
        let currentTeamIndex = 0;

        function renderSetup() {
            const container = document.getElementById('teams-container');
            container.innerHTML = "";
            teams.forEach((team, index) => {
                const row = document.createElement('div');
                row.className = 'config-row';
                row.innerHTML = `<input type="text" value="${team.name}" onchange="teams[${index}].name = this.value">`;
                container.appendChild(row);
            });
        }

        function addTeam() { 
            teams.push({ name: `√âquipe ${teams.length + 1}`, score: 0 }); 
            renderSetup(); 
        }

        function startCompliciteGame() {
            winningScore = parseInt(document.getElementById('win-score-input').value) || 0;
            document.getElementById('comp-setup').classList.add('hidden');
            document.getElementById('comp-game').classList.remove('hidden');
            nextRound();
        }

        function nextRound() {
            if (words.length === 0) words = [...baseWords];
            const idx = Math.floor(Math.random() * words.length);
            document.getElementById('word-to-guess').innerText = words[idx];
            words.splice(idx, 1);
            updateUI();
        }

        function updateUI() {
            const sb = document.getElementById('scoreboard');
            sb.innerHTML = "";
            teams.forEach((t, idx) => {
                const progress = winningScore > 0 ? (t.score / winningScore) * 100 : 0;
                const div = document.createElement('div');
                div.className = `team-score-box ${idx === currentTeamIndex ? 'team-active' : ''}`;
                div.innerHTML = `
                    <span class="ts-val">${t.score}</span>
                    <span class="ts-name">${t.name}</span>
                    <div style="width:100%; height:4px; background:rgba(255,255,255,0.1); margin-top:8px; border-radius:2px; overflow:hidden;">
                        <div style="width:${progress}%; height:100%; background:var(--neon-blue); transition:0.5s;"></div>
                    </div>`;
                sb.appendChild(div);
            });
            document.getElementById('turn-indicator').innerText = `Tour de : ${teams[currentTeamIndex].name}`;
        }

        // --- GESTION DU BOUTON INTERCEPT√â ---
        function handleStealAttempt() {
            if (teams.length === 2) {
                // Si 2 √©quipes : l'autre gagne le point automatiquement
                const beneficiaryIndex = (currentTeamIndex === 0) ? 1 : 0;
                roundEnd('steal', beneficiaryIndex);
            } else {
                // Si + de 2 √©quipes : on affiche la modale pour choisir qui vole
                const container = document.getElementById('steal-buttons-container');
                container.innerHTML = "";
                teams.forEach((t, idx) => {
                    if (idx !== currentTeamIndex) {
                        const btn = document.createElement('button');
                        btn.className = "btn btn-primary";
                        btn.innerText = t.name;
                        btn.onclick = () => { 
                            closeModal('modal-steal');
                            roundEnd('steal', idx); 
                        };
                        container.appendChild(btn);
                    }
                });
                document.getElementById('modal-steal').classList.remove('hidden');
            }
        }

        function roundEnd(type, beneficiaryIndex = null) {
            if (type === 'win') {
                teams[currentTeamIndex].score++;
            } else if (type === 'steal') {
                teams[beneficiaryIndex].score++;
            }
            
            // V√©rification de victoire
            let winnerFound = false;
            teams.forEach(t => {
                if (winningScore > 0 && t.score >= winningScore) {
                    document.getElementById('winner-name').innerText = t.name + " GAGNE !";
                    document.getElementById('modal-victory').classList.remove('hidden');
                    // D√©clenchement des confettis
                    confetti({
                        particleCount: 150,
                        spread: 70,
                        origin: { y: 0.6 }
                    });
                    winnerFound = true;
                }
            });

            if (!winnerFound) {
                currentTeamIndex = (currentTeamIndex + 1) % teams.length;
                nextRound();
            }
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }

        // --- LOGIQUE DE MAINTIEN ---
        const holdZone = document.getElementById('hold-zone');
        const wordDisplay = document.getElementById('word-to-guess');
        const holdInst = document.getElementById('hold-instruction');

        const show = (e) => {
            if(e.cancelable) e.preventDefault();
            wordDisplay.classList.add('visible');
            holdZone.classList.add('active');
            holdInst.style.opacity = "0";
        }
        const hide = () => {
            wordDisplay.classList.remove('visible');
            holdZone.classList.remove('active');
            holdInst.style.opacity = "1";
        }

        holdZone.addEventListener('mousedown', show);
        holdZone.addEventListener('mouseup', hide);
        holdZone.addEventListener('mouseleave', hide);
        holdZone.addEventListener('touchstart', show, {passive:false});
        holdZone.addEventListener('touchend', hide);

        renderSetup();
    </script>
</body>
</html>
